<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Aaron Cochrane" />

<meta name="date" content="2020-02-22" />

<title>TEfits explained</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">TEfits explained</h1>
<h4 class="author">Aaron Cochrane</h4>
<h4 class="date">2020-02-22</h4>



<div id="introduction-to-time-evolving-fits" class="section level2">
<h2>Introduction to Time-Evolving Fits</h2>
<p>Data is described, interpreted, and tested using indices such as d prime, mean, or psychometric function threshold. This package serves to allow the same questions to be asked about time-evolving aspects of these indices.</p>
<p>Nonlinear regression is on the fringes of many analysis domains. In the immortal words that accompany the codification of the so-called “Power Law of Practice,” Newell and Rosenbloom (1981) asserted that “Curve fitting without benefit of a model is notoriously a black art.” This notoriety has hardly diminished in the intervening decades, although the use of Generalized Additive Models and Gaussian Processes has certainly become more popular.</p>
<p>The <code>TEfits</code> package is intended to assist in the implementation and interpretation of nonlinear regression with a heavy emphasis on interpretability of parameters. Rather than a “black art,” parameters fit by <code>TEfits</code> are meant to reflect human-interpretable representations of time-evolving processes. Error functions, nonlinear (“change”) functions linking parameters and time to predicted values, parameter and prediction boundaries, and goodness-of-fit indices are intended to be clear and adjustable. An equal emphasis is on ease of use: minimal arguments are necessary to begin using the primary function, <code>TEfit()</code>, and many common tasks are fully automated (e.g., optimization starting points, bootstrapping).</p>
<p>The underlying goal of this package is to simplify the analysis of data [a response variable] that manifests as a saturating function of time. Many heuristics included in the package rely on this notion, e.g., exponential and power functions only are allowed to decay [are negative in the exponent]. Additionally, the default assumption is that he saturation should largely take place within the observed time. That is, if parameters of a time-evolving function are to be reliably estimated, the inflection point of the associated curve must be observed. This constraint allows the rejection of extreme curve shape parameters (i.e., “rate” parameters) which greatly improves the identifiability of nonlinear functions. That is to say, constraining this parameter reduces the possibility of mimicry of parameter combinations and the associated multiple error minima.</p>
<p>Other excellent packages exist that facilitate nonlinear regression (e.g., <em>brms</em>, <em>gnm</em>, <em>lme4</em>, <em>nlme</em>) as well as <em>stats::nls</em>. <em>TEfits</em> is designed to fill a gap in these previous packages in two ways:</p>
<ol style="list-style-type: decimal">
<li><p>Allow for non-normal distributions of response variables. Note that this means more than generalizing a (non-) linear model using a link function; in real data the likelihood function defining the error profile itself varies depending on the data being modeled. <em>brms</em> is the only one of the packages above that also allows this flexibility.</p></li>
<li><p>Lower the amount of expertise needed to implement nonlinear models. A core goal of <em>TEfits</em> is to minimize the barriers to parametric time-dependent analysis. While more custom and complex models can certainly be specified in a full modeling language (e.g., <em>Stan</em>) or one of its front-end packages (e.g., <em>brms</em>), <em>TEfits</em> is designed to open the door to users with minimal experience with nonlinear regression specification and implementation.</p></li>
</ol>
</div>
<div id="basic-fitting-yx" class="section level2">
<h2>Basic fitting: y~x</h2>
<p>explanation “under the hood” of parameters, parameterizations, interpretations</p>
<p>how starts work, what parameters are named, how GoF and spearmanchange works</p>
<p>what output is, summary(), plot(), simulate(), a</p>
<p>how to change errFun and changeFun</p>
</div>
<div id="including-covariates" class="section level2">
<h2>Including covariates</h2>
<p>explanation “under the hood” as multilevel model, with linear models predicting the nonlinear parameters covariates for everything, and for only some recommendations about limits and values… 2? centered, or is intercept calculated? special case of “covariate” is blockfun</p>
</div>
<div id="link-functions" class="section level2">
<h2>Link functions:</h2>
<p>how it works for defining the logistX how logistic works</p>
<p>how it works for presence – how d_prime works – Note that a hwhm argument below ~.25 will essentially return 5 discrete levels of d-prime and can be considered the least smoothed option.</p>
</div>
<div id="resampling" class="section level2">
<h2>resampling</h2>
<p>how it works: nitty gritty, and also output what to expect: ==1 what to expect: &lt;1 (e.g., non-good CI)</p>
</div>
<div id="drawing-inferences" class="section level2">
<h2>Drawing inferences</h2>
<p>How to assess model fit? How to tell whether using a time-evolving function to describe your data is “worth it?” Three primary methods are recommended: (1) Compare BIC – a negative delta BIC indicates that your parameters decreased error enough to justify their inclusion; (2) Compare conditional independence – a Spearman correlation between your response variable and time that is smaller with the model than without the model indicates that your model is removing a pre-existing bias in your data, and proportional Spearman change can help with this comparison; (3) See how robust the directional trend is – bootstrap your fit and see whether the time-dependent increase (or decrease) in predicted values is consistent across your resampled parameters. Each of these methods of evaluating fit are available from the summary() function. Of course, the above can also be used to compare fits with different change functions, covariates, fixed parameters, etc.</p>
</div>
<div id="down-the-rabbit-hole-control" class="section level2">
<h2>Down the rabbit hole: <code>control</code></h2>
<p>implications of ylim, default ylim, and custom ylim</p>
<p>implications of ratelim, default ratelim, and custom rate … implications and reasons around penalizing error</p>
</div>
<div id="change-functions-explained." class="section level2">
<h2>Change functions, explained.</h2>
</div>
<div id="link-functions-explained" class="section level2">
<h2>Link functions, explained</h2>
<p>Identity</p>
<p>Logistic</p>
</div>
<div id="error-functions-explained." class="section level2">
<h2>Error functions, explained.</h2>
<p>what is an error function, how is convergence checked, what are GoF measures calculated</p>
<p>what are each qualitatively, what are each implemented as.</p>
<p><code>logcosh</code>: the log hyperbolic cosine error function can be thought of as an interpolation between ordinary least squares (OLS) and absolute errors (median regression). At small absolute errors logcosh increases with an increasing slope. At large absolute errors logcosh increases with a near-constant slope of 1. More specifically, it is approximately equal to (error^2)/2 for small errors and to abs(error)-log(2) for large error. This means that below values of around 20, there is nonzero second derivative that is helpful to optimization routines. In reality this curvilinear regime is always shallower than OLS, making <code>logcosh</code> consistently less influenced by outlying data. <em>Implementation:</em> <code>log(cosh(y-yHat))</code></p>
</div>
<div id="do-you-want-complete-control" class="section level2">
<h2>Do you want complete control?</h2>
<p>For more traditional nonlinear regression, in which a formula is explicitly stated, define the formula in the control list. Convergence criterion can also be set arbitrarily low to simply return the best-fit model after the desired number of runs (note that, regardless of the number of runs, a warning regarding nonconvergence will likely be printed).</p>
<p><code>TEfit(varIn[,c('y','time_v')],control=list(explicit='y~a_par+log(1/time_v^b_par)',nTries=1E3,convergeTol=1E-10))</code></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>cite Wichman Hill 2001 I for bernoulli likelihood, and other things. also: Strasburger, H. Perception &amp; Psychophysics (2001) 63: 1348. <a href="https://doi.org/10.3758/BF03194547" class="uri">https://doi.org/10.3758/BF03194547</a></p>
<p>read Gold Law Connolly Bennur 2010 (has a parameterization for time-dependent threshold and time-independent shape of Weibull) P(C) = 0.5 + (0.5 - lapseRate)(1 - expBase<sup>(-(stim_strength/threshold)</sup>shape)) [expBase=2.0851 so threshold point is at d’=1]</p>
<p>cite Klein 2001</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
